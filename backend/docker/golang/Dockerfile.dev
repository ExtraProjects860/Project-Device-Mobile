FROM golang:1.24-alpine AS dev

WORKDIR /app

RUN apk add --no-cache git bash make gcc musl-dev

ENV PATH="/go/bin:/usr/local/go/bin:${PATH}"

RUN go install github.com/air-verse/air@latest && go install github.com/swaggo/swag/cmd/swag@latest && go install -tags 'postgres' github.com/golang-migrate/migrate/v4/cmd/migrate@latest

COPY api/go.mod api/go.sum ./

COPY api/ .

RUN go mod download

CMD ["air"]
